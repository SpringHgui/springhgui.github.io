<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Three.js æ‰“é€ ç¼¤çº·å¤æ—¥3Dæ¢¦ä¸­æƒ…å²› ğŸŒŠ | dotnetä¹‹ç¾</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Three.js æ‰“é€ ç¼¤çº·å¤æ—¥3Dæ¢¦ä¸­æƒ…å²› ğŸŒŠ" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="å£°æ˜ï¼šæœ¬æ–‡æ¶‰åŠå›¾æ–‡å’Œæ¨¡å‹ç´ æä»…ç”¨äºä¸ªäººå­¦ä¹ ã€ç ”ç©¶å’Œæ¬£èµï¼Œè¯·å‹¿äºŒæ¬¡ä¿®æ”¹ã€éæ³•ä¼ æ’­ã€è½¬è½½ã€å‡ºç‰ˆã€å•†ç”¨ã€åŠè¿›è¡Œå…¶ä»–è·åˆ©è¡Œä¸ºã€‚" />
<meta property="og:description" content="å£°æ˜ï¼šæœ¬æ–‡æ¶‰åŠå›¾æ–‡å’Œæ¨¡å‹ç´ æä»…ç”¨äºä¸ªäººå­¦ä¹ ã€ç ”ç©¶å’Œæ¬£èµï¼Œè¯·å‹¿äºŒæ¬¡ä¿®æ”¹ã€éæ³•ä¼ æ’­ã€è½¬è½½ã€å‡ºç‰ˆã€å•†ç”¨ã€åŠè¿›è¡Œå…¶ä»–è·åˆ©è¡Œä¸ºã€‚" />
<link rel="canonical" href="/cnblog/2022/05/27/Three.js-%E6%89%93%E9%80%A0%E7%BC%A4%E7%BA%B7%E5%A4%8F%E6%97%A53D%E6%A2%A6%E4%B8%AD%E6%83%85%E5%B2%9B.html" />
<meta property="og:url" content="/cnblog/2022/05/27/Three.js-%E6%89%93%E9%80%A0%E7%BC%A4%E7%BA%B7%E5%A4%8F%E6%97%A53D%E6%A2%A6%E4%B8%AD%E6%83%85%E5%B2%9B.html" />
<meta property="og:site_name" content="dotnetä¹‹ç¾" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-05-27T08:36:30+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Three.js æ‰“é€ ç¼¤çº·å¤æ—¥3Dæ¢¦ä¸­æƒ…å²› ğŸŒŠ" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-27T08:36:30+00:00","datePublished":"2022-05-27T08:36:30+00:00","description":"å£°æ˜ï¼šæœ¬æ–‡æ¶‰åŠå›¾æ–‡å’Œæ¨¡å‹ç´ æä»…ç”¨äºä¸ªäººå­¦ä¹ ã€ç ”ç©¶å’Œæ¬£èµï¼Œè¯·å‹¿äºŒæ¬¡ä¿®æ”¹ã€éæ³•ä¼ æ’­ã€è½¬è½½ã€å‡ºç‰ˆã€å•†ç”¨ã€åŠè¿›è¡Œå…¶ä»–è·åˆ©è¡Œä¸ºã€‚","headline":"Three.js æ‰“é€ ç¼¤çº·å¤æ—¥3Dæ¢¦ä¸­æƒ…å²› ğŸŒŠ","mainEntityOfPage":{"@type":"WebPage","@id":"/cnblog/2022/05/27/Three.js-%E6%89%93%E9%80%A0%E7%BC%A4%E7%BA%B7%E5%A4%8F%E6%97%A53D%E6%A2%A6%E4%B8%AD%E6%83%85%E5%B2%9B.html"},"url":"/cnblog/2022/05/27/Three.js-%E6%89%93%E9%80%A0%E7%BC%A4%E7%BA%B7%E5%A4%8F%E6%97%A53D%E6%A2%A6%E4%B8%AD%E6%83%85%E5%B2%9B.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="dotnetä¹‹ç¾" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">dotnetä¹‹ç¾</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Three.js æ‰“é€ ç¼¤çº·å¤æ—¥3Dæ¢¦ä¸­æƒ…å²› ğŸŒŠ</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2022-05-27T08:36:30+00:00" itemprop="datePublished">May 27, 2022
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <blockquote>
  <p>å£°æ˜ï¼šæœ¬æ–‡æ¶‰åŠå›¾æ–‡å’Œæ¨¡å‹ç´ æä»…ç”¨äºä¸ªäººå­¦ä¹ ã€ç ”ç©¶å’Œæ¬£èµï¼Œè¯·å‹¿äºŒæ¬¡ä¿®æ”¹ã€éæ³•ä¼ æ’­ã€è½¬è½½ã€å‡ºç‰ˆã€å•†ç”¨ã€åŠè¿›è¡Œå…¶ä»–è·åˆ©è¡Œä¸ºã€‚</p>
</blockquote>

<p><img src="https://img2022.cnblogs.com/blog/772544/202205/772544-20220527084420708-1192650956.gif" alt="" /></p>

<h2 id="èƒŒæ™¯">èƒŒæ™¯</h2>

<p>æ·±å±…å†…é™†çš„äººä»¬ï¼Œå¤§æ¦‚æ¯ä¸ªäººéƒ½æœ‰è¿‡å¤§æµ·ä¹‹æ¢¦å§ã€‚å¤æ—¥å‚æ™šåœ¨æ²™æ»©æ¼«æ­¥å¥”è·‘ï¼›æˆ–æ˜¯åœ¨æµ·ä¸Šå†²æµªæ¸¸æ³³ï¼›æˆ–æ˜¯åœ¨æµ·å²›æ¸¸ç©æ¢é™©ï¼›äº¦æˆ–é™å¾…æ—¥å‡ºæ—¥è½â€¦â€¦æœ¬æ–‡ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">React + Three.js</code> æŠ€æœ¯æ ˆï¼Œå®ç° <code class="language-plaintext highlighter-rouge">3D</code> æµ·æ´‹å’Œå²›å±¿ï¼Œä¸»è¦åŒ…å«çŸ¥è¯†ç‚¹åŒ…æ‹¬ï¼š<code class="language-plaintext highlighter-rouge">Tone Mapping</code>ã€<code class="language-plaintext highlighter-rouge">Water</code> ç±»ã€<code class="language-plaintext highlighter-rouge">Sky</code> ç±»ã€<code class="language-plaintext highlighter-rouge">Shader</code> ç€è‰²ã€<code class="language-plaintext highlighter-rouge">ShaderMaterial</code> ç€è‰²å™¨æè´¨ã€<code class="language-plaintext highlighter-rouge">Raycaster</code> æ£€æµ‹é®æŒ¡ä»¥åŠ <code class="language-plaintext highlighter-rouge">Three.js</code> çš„å…¶ä»–åŸºç¡€çŸ¥è¯†ï¼Œè®©æˆ‘ä»¬åœ¨è¿™ä¸ªå¤å¤©é€šè¿‡æ­¤é¡µé¢å…±èµ´å¤§æµ·ä¹‹çº¦ã€‚</p>

<h2 id="æ•ˆæœ">æ•ˆæœ</h2>

<p><img src="https://img2022.cnblogs.com/blog/772544/202205/772544-20220527084442410-1141227374.png" alt="" /></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">ğŸ’»</code> æœ¬é¡µé¢ä»…é€‚é… <code class="language-plaintext highlighter-rouge">PC</code> ç«¯ï¼Œå¤§å±è®¿é—®æ•ˆæœæ›´ä½³ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">ğŸ‘â€ğŸ—¨</code> åœ¨çº¿é¢„è§ˆåœ°å€1ï¼š<a href="https://3d-eosin.vercel.app/#/ocean">https://3d-eosin.vercel.app/#/ocean</a></li>
  <li><code class="language-plaintext highlighter-rouge">ğŸ‘â€ğŸ—¨</code> åœ¨çº¿é¢„è§ˆåœ°å€2ï¼š<a href="https://dragonir.github.io/3d/#/ocean">https://dragonir.github.io/3d/#/ocean</a></li>
</ul>

<h2 id="å®ç°">å®ç°</h2>

<h3 id="-ç´ æå‡†å¤‡">ğŸ‘¨â€ğŸ¨ ç´ æå‡†å¤‡</h3>

<p>å¼€å‘ä¹‹å‰ï¼Œéœ€è¦å‡†å¤‡é¡µé¢æ‰€éœ€çš„ç´ æï¼Œæœ¬æ–‡ç”¨åˆ°çš„æµ·å²›ç´ ææ˜¯åœ¨ <a href="https://sketchfab.com/feed">sketchfab.com</a> æ‰¾çš„å…è´¹æ¨¡å‹ã€‚ä¸‹è½½å¥½ç´ æä¹‹åï¼Œåœ¨ <code class="language-plaintext highlighter-rouge">Blender</code> ä¸­æ‰“å¼€ï¼ŒæŒ‰è‡ªå·±çš„æƒ³æ³•è°ƒæ•´æ¨¡å‹çš„é¢œè‰²ã€æè´¨ã€å¤§å°æ¯”ä¾‹ã€è§’åº¦ã€ä½ç½®ç­‰ä¿¡æ¯ï¼Œåˆ å‡ä¸éœ€è¦çš„æ¨¡å—ã€ç¼©å‡é¢æ•°ä»¥å‹ç¼©æ¨¡å‹ä½“ç§¯ï¼Œæœ€ååˆ é™¤ç›¸æœºã€å…‰ç…§ã€<code class="language-plaintext highlighter-rouge">UV</code>ã€åŠ¨ç”»ç­‰å¤šä½™ä¿¡æ¯ï¼Œ<strong>åªå¯¼å‡ºæ¨¡å‹ç½‘æ ¼</strong>å¤‡ç”¨ã€‚</p>

<p><img src="https://img2022.cnblogs.com/blog/772544/202205/772544-20220527084454778-35559124.png" alt="" /></p>

<h3 id="-èµ„æºå¼•å…¥">ğŸ“¦ èµ„æºå¼•å…¥</h3>

<p>é¦–å…ˆï¼Œå¼•å…¥å¼€å‘æ‰€éœ€çš„å¿…å¤‡èµ„æºï¼Œ<code class="language-plaintext highlighter-rouge">OrbitControls</code> ç”¨äºé•œå¤´è½¨é“æ§åˆ¶ï¼›<code class="language-plaintext highlighter-rouge">GLTFLoader</code> ç”¨äºåŠ è½½ <code class="language-plaintext highlighter-rouge">gltf</code> æ ¼å¼æ¨¡å‹ï¼›<code class="language-plaintext highlighter-rouge">Water</code> æ˜¯ <code class="language-plaintext highlighter-rouge">Three.js</code> å†…ç½®çš„ä¸€ä¸ªç±»ï¼Œå¯ä»¥ç”Ÿæˆç±»ä¼¼æ°´çš„æ•ˆæœï¼›<code class="language-plaintext highlighter-rouge">Sky</code> å¯ä»¥ç”Ÿæˆå¤©ç©ºæ•ˆæœï¼›<code class="language-plaintext highlighter-rouge">TWEEN</code> ç”¨æ¥ç”Ÿæˆè¡¥é—´åŠ¨ç”»ï¼›<code class="language-plaintext highlighter-rouge">Animations</code> æ˜¯å¯¹ <code class="language-plaintext highlighter-rouge">TWEEN</code> æ§åˆ¶é•œå¤´è¡¥é—´åŠ¨ç”»æ–¹æ³•çš„å°è£…ï¼›<code class="language-plaintext highlighter-rouge">waterTexture</code> ã€<code class="language-plaintext highlighter-rouge">flamingoModel</code>ã€<code class="language-plaintext highlighter-rouge">islandModel</code> ä¸‰è€…åˆ†åˆ«æ˜¯æ°´çš„æ³•å‘è´´å›¾ã€é£é¸Ÿæ¨¡å‹ã€æµ·å²›æ¨¡å‹ï¼›<code class="language-plaintext highlighter-rouge">vertexShader</code> å’Œ <code class="language-plaintext highlighter-rouge">fragmentShader</code> æ˜¯ç”¨äºç”Ÿæˆå½©è™¹çš„ <code class="language-plaintext highlighter-rouge">Shader</code> ç€è‰²å™¨ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import * as THREE from "three";
import { OrbitControls } from "three/examples/jsm/controls/OrbitControls";
import { GLTFLoader } from "three/examples/jsm/loaders/GLTFLoader";
import { Water } from 'three/examples/jsm/objects/Water';
import { Sky } from 'three/examples/jsm/objects/Sky';
import { TWEEN } from "three/examples/jsm/libs/tween.module.min";
import Animations from '@/assets/utils/animations';
import waterTexture from '@/containers/Ocean/images/waternormals.jpg';
import islandModel from '@/containers/Ocean/models/island.glb';
import flamingoModel from '@/containers/Ocean/models/flamingo.glb';
import vertexShader from '@/containers/Ocean/shaders/rainbow/vertex.glsl';
import fragmentShader from '@/containers/Ocean/shaders/rainbow/fragment.glsl';
</code></pre></div></div>

<h3 id="-é¡µé¢ç»“æ„">ğŸ“ƒ é¡µé¢ç»“æ„</h3>

<p>é¡µé¢ä¸»è¦ç”±3éƒ¨åˆ†æ„æˆï¼š<code class="language-plaintext highlighter-rouge">canvas.webgl</code> ç”¨äºæ¸²æŸ“ <code class="language-plaintext highlighter-rouge">WEBGL</code> åœºæ™¯ï¼›<code class="language-plaintext highlighter-rouge">div.loading</code> ç”¨äºæ¨¡å‹åŠ è½½å®Œæˆå‰æ˜¾ç¤ºåŠ è½½è¿›åº¦ï¼›<code class="language-plaintext highlighter-rouge">div.point</code> ç”¨äºæ·»åŠ äº¤äº’ç‚¹ï¼Œçœç•¥éƒ¨åˆ†æ˜¯å…¶ä»–å‡ ä¸ªäº¤äº’ç‚¹ä¿¡æ¯ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>render () {
  return (
    &lt;div className='ocean'&gt;
      &lt;canvas className='webgl'&gt;&lt;/canvas&gt;
      {this.state.loadingProcess === 100 ? '' : (
        &lt;div className='loading'&gt;
          &lt;span className='progress'&gt;{this.state.loadingProcess} %&lt;/span&gt;
        &lt;/div&gt;
      )}
      &lt;div className="point point-0"&gt;
        &lt;div className="label label-0"&gt;1&lt;/div&gt;
        &lt;div className="text"&gt;ç¯å¡”ï¼šçŸ—ç«‹åœ¨æµ·å²¸çš„å²©çŸ³ä¹‹ä¸Šï¼Œç™½è‰²çš„å¡”èº«ä»¥åŠçº¢è‰²çš„å¡”å±‹ï¼Œåœ¨æ¹›è“è‰²çš„å¤©ç©ºå’Œæ·±è“è‰²å¤§æµ·çš„æ˜ è¡¬ä¸‹ï¼Œæ˜¾å¾—å¦‚æ­¤é†’ç›®å’Œç¾ä¸½ã€‚&lt;/div&gt;
      &lt;/div&gt;
      // ...
    &lt;/div&gt;
  )
}
</code></pre></div></div>

<h3 id="-åœºæ™¯åˆå§‹åŒ–">ğŸŒ åœºæ™¯åˆå§‹åŒ–</h3>

<p>åœ¨è¿™éƒ¨åˆ†ï¼Œå…ˆå®šä¹‰å¥½éœ€è¦çš„çŠ¶æ€å€¼ï¼Œ<code class="language-plaintext highlighter-rouge">loadingProcess</code> ç”¨äºæ˜¾ç¤ºé¡µé¢åŠ è½½è¿›åº¦ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>state = {
  loadingProcess: 0
}
</code></pre></div></div>

<p>å®šä¹‰ä¸€äº›å…¨å±€å˜é‡å’Œå‚æ•°ï¼Œåˆå§‹åŒ–åœºæ™¯ã€ç›¸æœºã€é•œå¤´è½¨é“æ§åˆ¶å™¨ã€ç¯å…‰ã€é¡µé¢ç¼©æ”¾ç›‘å¬ç­‰ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const clock = new THREE.Clock();
const raycaster = new THREE.Raycaster()
const sizes = {
  width: window.innerWidth,
  height: window.innerHeight
}
const renderer = new THREE.WebGLRenderer({
  canvas: document.querySelector('canvas.webgl'),
  antialias: true
});
renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2))
renderer.setSize(sizes.width, sizes.height);
// è®¾ç½®æ¸²æŸ“æ•ˆæœ
renderer.toneMapping = THREE.ACESFilmicToneMapping;
// åˆ›å»ºåœºæ™¯
const scene = new THREE.Scene();
// åˆ›å»ºç›¸æœº
const camera = new THREE.PerspectiveCamera(55, sizes.width / sizes.height, 1, 20000);
camera.position.set(0, 600, 1600);
// æ·»åŠ é•œå¤´è½¨é“æ§åˆ¶å™¨
const controls = new OrbitControls(camera, renderer.domElement);
controls.target.set(0, 0, 0);
controls.enableDamping = true;
controls.enablePan = false;
controls.maxPolarAngle = 1.5;
controls.minDistance = 50;
controls.maxDistance = 1200;
// æ·»åŠ ç¯å¢ƒå…‰
const ambientLight = new THREE.AmbientLight(0xffffff, .8);
scene.add(ambientLight);
// æ·»åŠ å¹³è¡Œå…‰
const dirLight = new THREE.DirectionalLight(0xffffff, 1);
dirLight.color.setHSL(.1, 1, .95);
dirLight.position.set(-1, 1.75, 1);
dirLight.position.multiplyScalar(30);
scene.add(dirLight);
// é¡µé¢ç¼©æ”¾ç›‘å¬å¹¶é‡æ–°æ›´æ–°åœºæ™¯å’Œç›¸æœº
window.addEventListener('resize', () =&gt; {
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
}, false);
</code></pre></div></div>

<h4 id="-tone-mapping"><code class="language-plaintext highlighter-rouge">ğŸ’¡</code> Tone Mapping</h4>

<p>å¯ä»¥æ³¨æ„åˆ°ï¼Œæœ¬æ–‡ä½¿ç”¨äº† <code class="language-plaintext highlighter-rouge">renderer.toneMapping = THREE.ACESFilmicToneMapping</code> æ¥è®¾ç½®é¡µé¢æ¸²æŸ“æ•ˆæœã€‚ç›®å‰ <code class="language-plaintext highlighter-rouge">Three.js</code> ä¸­æœ‰ä»¥ä¸‹å‡ ç§ <code class="language-plaintext highlighter-rouge">Tone Mapping</code> å€¼ï¼Œå®ƒä»¬å®šä¹‰äº† <code class="language-plaintext highlighter-rouge">WebGLRenderer</code> çš„ <code class="language-plaintext highlighter-rouge">toneMapping</code> å±æ€§ï¼Œç”¨äºåœ¨è¿‘ä¼¼æ ‡å‡†è®¡ç®—æœºæ˜¾ç¤ºå™¨æˆ–ç§»åŠ¨è®¾å¤‡çš„ä½åŠ¨æ€èŒƒå›´ <code class="language-plaintext highlighter-rouge">LDR</code> å±å¹•ä¸Šå±•ç¤ºé«˜åŠ¨æ€èŒƒå›´ <code class="language-plaintext highlighter-rouge">HDR</code> å¤–è§‚ã€‚å¤§å®¶å¯ä»¥ä¿®æ”¹ä¸åŒçš„å€¼çœ‹çœ‹æ¸²æŸ“æ•ˆæœæœ‰ä½•ä¸åŒã€‚</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">THREE.NoToneMapping</code></li>
  <li><code class="language-plaintext highlighter-rouge">THREE.LinearToneMapping</code></li>
  <li><code class="language-plaintext highlighter-rouge">THREE.ReinhardToneMapping</code></li>
  <li><code class="language-plaintext highlighter-rouge">THREE.CineonToneMapping</code></li>
  <li><code class="language-plaintext highlighter-rouge">THREE.ACESFilmicToneMapping</code></li>
</ul>

<h3 id="-æµ·">ğŸŒŠ æµ·</h3>

<p>ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">Three.js</code> è‡ªå¸¦çš„ <code class="language-plaintext highlighter-rouge">Water</code> ç±»åˆ›å»ºæµ·æ´‹ï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ªå¹³é¢ç½‘æ ¼ <code class="language-plaintext highlighter-rouge">waterGeometry</code>ï¼Œè®©åå°†å®ƒä¼ é€’ç»™ <code class="language-plaintext highlighter-rouge">Water</code>ï¼Œå¹¶é…ç½®ç›¸å…³å±æ€§ï¼Œæœ€åå°†æµ·æ´‹æ·»åŠ åˆ°åœºæ™¯ä¸­ã€‚</p>

<p><img src="https://img2022.cnblogs.com/blog/772544/202205/772544-20220527084516951-1880876264.png" alt="" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const waterGeometry = new THREE.PlaneGeometry(10000, 10000);
const water = new Water(waterGeometry, {
  textureWidth: 512,
  textureHeight: 512,
  waterNormals: new THREE.TextureLoader().load(waterTexture,  texture =&gt; {
    texture.wrapS = texture.wrapT = THREE.RepeatWrapping;
  }),
  sunDirection: new THREE.Vector3(),
  sunColor: 0xffffff,
  waterColor: 0x0072ff,
  distortionScale: 4,
  fog: scene.fog !== undefined
});
water.rotation.x = - Math.PI / 2;
scene.add(water);
</code></pre></div></div>

<h4 id="-water-ç±»"><code class="language-plaintext highlighter-rouge">ğŸ’¡</code> Water ç±»</h4>

<p><strong>å‚æ•°è¯´æ˜</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">textureWidth</code>ï¼šç”»å¸ƒå®½åº¦</li>
  <li><code class="language-plaintext highlighter-rouge">textureHeight</code>ï¼šç”»å¸ƒé«˜åº¦</li>
  <li><code class="language-plaintext highlighter-rouge">waterNormals</code>ï¼šæ³•å‘é‡è´´å›¾</li>
  <li><code class="language-plaintext highlighter-rouge">sunDirection</code>ï¼šé˜³å…‰æ–¹å‘</li>
  <li><code class="language-plaintext highlighter-rouge">sunColor</code>ï¼šé˜³å…‰é¢œè‰²</li>
  <li><code class="language-plaintext highlighter-rouge">waterColor</code>ï¼šæ°´é¢œè‰²</li>
  <li><code class="language-plaintext highlighter-rouge">distortionScale</code>ï¼šç‰©ä½“å€’å½±åˆ†æ•£åº¦</li>
  <li><code class="language-plaintext highlighter-rouge">fog</code>ï¼šé›¾</li>
  <li><code class="language-plaintext highlighter-rouge">alpha</code>ï¼šé€æ˜åº¦</li>
</ul>

<p><img src="https://img2022.cnblogs.com/blog/772544/202205/772544-20220527084538354-90419473.gif" alt="" /></p>

<h3 id="-ç©º">ğŸŒ ç©º</h3>

<p>æ¥ç€ï¼Œä½¿ç”¨ <code class="language-plaintext highlighter-rouge">Three.js</code> è‡ªå¸¦çš„å¤©ç©ºç±» <code class="language-plaintext highlighter-rouge">Sky</code> åˆ›å»ºå¤©ç©ºï¼Œé€šè¿‡ä¿®æ”¹ç€è‰²å™¨å‚æ•°è®¾ç½®å¤©ç©ºæ ·å¼ï¼Œç„¶ååˆ›å»ºå¤ªé˜³å¹¶æ·»åŠ åˆ°åœºæ™¯ä¸­ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const sky = new Sky();
sky.scale.setScalar(10000);
scene.add(sky);
const skyUniforms = sky.material.uniforms;
skyUniforms['turbidity'].value = 20;
skyUniforms['rayleigh'].value = 2;
skyUniforms['mieCoefficient'].value = 0.005;
skyUniforms['mieDirectionalG'].value = 0.8;
// å¤ªé˜³
const sun = new THREE.Vector3();
const pmremGenerator = new THREE.PMREMGenerator(renderer);
const phi = THREE.MathUtils.degToRad(88);
const theta = THREE.MathUtils.degToRad(180);
sun.setFromSphericalCoords(1, phi, theta);
sky.material.uniforms['sunPosition'].value.copy(sun);
water.material.uniforms['sunDirection'].value.copy(sun).normalize();
scene.environment = pmremGenerator.fromScene(sky).texture;
</code></pre></div></div>

<h4 id="-sky-ç±»"><code class="language-plaintext highlighter-rouge">ğŸ’¡</code> Sky ç±»</h4>

<p><strong>å¤©ç©ºæè´¨ç€è‰²å™¨å‚æ•°è¯´æ˜</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">turbidity</code> æµ‘æµŠåº¦</li>
  <li><code class="language-plaintext highlighter-rouge">rayleigh</code> è§†è§‰æ•ˆæœå°±æ˜¯å‚æ™šæ™šéœçš„çº¢å…‰çš„æ·±åº¦</li>
  <li><code class="language-plaintext highlighter-rouge">luminance</code> è§†è§‰æ•ˆæœæ•´ä½“æäº®æˆ–å˜æš—</li>
  <li><code class="language-plaintext highlighter-rouge">mieCoefficient</code> æ•£å°„ç³»æ•°</li>
  <li><code class="language-plaintext highlighter-rouge">mieDirectionalG</code> å®šå‘æ•£å°„å€¼</li>
</ul>

<p><img src="https://img2022.cnblogs.com/blog/772544/202205/772544-20220527084559915-1147282276.gif" alt="" /></p>

<h3 id="-è™¹">ğŸŒˆ è™¹</h3>

<p>é¦–å…ˆï¼Œåˆ›å»ºå…·æœ‰å½©è™¹æ¸å˜æ•ˆæœçš„ç€è‰²å™¨ <code class="language-plaintext highlighter-rouge">Shader</code>, ç„¶åä½¿ç”¨ç€è‰²å™¨æè´¨ <code class="language-plaintext highlighter-rouge">ShaderMaterial</code>ï¼Œ åˆ›å»ºåœ†ç¯ <code class="language-plaintext highlighter-rouge">THREE.TorusGeometry</code> å¹¶æ·»åŠ åˆ°åœºæ™¯ä¸­ã€‚</p>

<p><strong>é¡¶ç‚¹ç€è‰²å™¨ vertex.glsl</strong>ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>varying vec2 vUV;
varying vec3 vNormal;
void main () {
  vUV = uv;
  vNormal = vec3(normal);
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
</code></pre></div></div>

<p><strong>ç‰‡æ®µç€è‰²å™¨ fragment.glsl</strong>ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>varying vec2 vUV;
varying vec3 vNormal;
void main () {
  vec4 c = vec4(abs(vNormal) + vec3(vUV, 0.0), 0.1); // è®¾ç½®é€æ˜åº¦ä¸º0.1
  gl_FragColor = c;
}
</code></pre></div></div>

<p><strong>å½©è™¹æ¸å˜ç€è‰²å™¨æ•ˆæœ</strong>ï¼š</p>

<p><img src="https://img2022.cnblogs.com/blog/772544/202205/772544-20220527084614968-974971802.png" alt="" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const material = new THREE.ShaderMaterial({
  side: THREE.DoubleSide,
  transparent: true,
  uniforms: {},
  vertexShader: vertexShader,
  fragmentShader: fragmentShader
});
const geometry = new THREE.TorusGeometry(200, 10, 50, 100);
const torus = new THREE.Mesh(geometry, material);
torus.opacity = .1;
torus.position.set(0, -50, -400);
scene.add(torus);
</code></pre></div></div>

<p><img src="https://img2022.cnblogs.com/blog/772544/202205/772544-20220527084626147-524969696.png" alt="" /></p>

<h4 id="-shader-ç€è‰²å™¨"><code class="language-plaintext highlighter-rouge">ğŸ’¡</code> Shader ç€è‰²å™¨</h4>

<p><code class="language-plaintext highlighter-rouge">WebGL</code> ä¸­è®°è¿°äº†åæ ‡å˜æ¢çš„æœºåˆ¶å°±å«åšç€è‰²å™¨ <code class="language-plaintext highlighter-rouge">Shader</code>ï¼Œç€è‰²å™¨åˆæœ‰å¤„ç†å‡ ä½•å›¾å½¢é¡¶ç‚¹çš„ <code class="language-plaintext highlighter-rouge">é¡¶ç‚¹ç€è‰²å™¨</code> å’Œå¤„ç†åƒç´ çš„ <code class="language-plaintext highlighter-rouge">ç‰‡æ®µç€è‰²å™¨</code> ä¸¤ç§ç±»å‹</p>

<h5 id="å‡†å¤‡é¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡å…ƒç€è‰²å™¨">å‡†å¤‡é¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡å…ƒç€è‰²å™¨</h5>

<p>ç€è‰²å™¨çš„æ·»åŠ æœ‰å¤šç§æ–¹æ³•ï¼Œæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯æŠŠç€è‰²å™¨è®°å½•åœ¨ <code class="language-plaintext highlighter-rouge">HTML</code> ä¸­ã€‚è¯¥æ–¹æ³•åˆ©ç”¨<code class="language-plaintext highlighter-rouge">HTML</code> çš„ <code class="language-plaintext highlighter-rouge">script</code> æ ‡ç­¾æ¥å®ç°ï¼Œå¦‚ï¼š</p>

<p><strong>é¡¶ç‚¹ç€è‰²å™¨</strong>ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;script id="vshader" type="x-shader/x-vertex"&gt;&lt;/script&gt;
</code></pre></div></div>

<p><strong>ç‰‡æ®µç€è‰²å™¨</strong>ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;script id="fshader" type="x-shader/x-fragment"&gt;&lt;/script&gt;
</code></pre></div></div>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">ğŸ</code> ä¹Ÿå¯ä»¥åƒæœ¬æ–‡ä¸­ä¸€æ ·ï¼Œç›´æ¥ä½¿ç”¨å•ç‹¬åˆ›å»º <code class="language-plaintext highlighter-rouge">glsl</code> æ ¼å¼æ–‡ä»¶å¼•å…¥ã€‚</p>
</blockquote>

<h5 id="ç€è‰²å™¨çš„ä¸‰ä¸ªå˜é‡ä¸è¿è¡Œæ–¹å¼">ç€è‰²å™¨çš„ä¸‰ä¸ªå˜é‡ä¸è¿è¡Œæ–¹å¼</h5>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Uniforms</code>ï¼šæ˜¯æ‰€æœ‰é¡¶ç‚¹éƒ½å…·æœ‰ç›¸åŒçš„å€¼çš„å˜é‡ã€‚ æ¯”å¦‚ç¯å…‰ï¼Œé›¾ï¼Œå’Œé˜´å½±è´´å›¾å°±æ˜¯è¢«å‚¨å­˜åœ¨ <code class="language-plaintext highlighter-rouge">uniforms</code> ä¸­çš„æ•°æ®ã€‚<code class="language-plaintext highlighter-rouge">uniforms</code> å¯ä»¥é€šè¿‡é¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡å…ƒç€è‰²å™¨æ¥è®¿é—®ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">Attributes</code>ï¼šæ˜¯ä¸æ¯ä¸ªé¡¶ç‚¹å…³è”çš„å˜é‡ã€‚ä¾‹å¦‚ï¼Œé¡¶ç‚¹ä½ç½®ï¼Œæ³•çº¿å’Œé¡¶ç‚¹é¢œè‰²éƒ½æ˜¯å­˜å‚¨åœ¨ <code class="language-plaintext highlighter-rouge">attributes</code> ä¸­çš„æ•°æ®ã€‚<code class="language-plaintext highlighter-rouge">attributes</code> åªå¯ä»¥åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­è®¿é—®ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">Varyings</code>ï¼šæ˜¯ä»é¡¶ç‚¹ç€è‰²å™¨ä¼ é€’åˆ°ç‰‡å…ƒç€è‰²å™¨çš„å˜é‡ã€‚å¯¹äºæ¯ä¸€ä¸ªç‰‡å…ƒï¼Œæ¯ä¸€ä¸ª<code class="language-plaintext highlighter-rouge">varying</code> çš„å€¼å°†æ˜¯ç›¸é‚»é¡¶ç‚¹å€¼çš„å¹³æ»‘æ’å€¼ã€‚</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">é¡¶ç‚¹ç€è‰²å™¨</code> é¦–å…ˆè¿è¡Œï¼Œå®ƒæ¥æ”¶ <code class="language-plaintext highlighter-rouge">attributes</code>ï¼Œ è®¡ç®—æ¯ä¸ªå•ç‹¬é¡¶ç‚¹çš„ä½ç½®ï¼Œå¹¶å°†å…¶ä»–æ•°æ®<code class="language-plaintext highlighter-rouge">varyings</code> ä¼ é€’ç»™ç‰‡æ®µç€è‰²å™¨ã€‚<code class="language-plaintext highlighter-rouge">ç‰‡æ®µç€è‰²å™¨</code> åè¿è¡Œï¼Œå®ƒè®¾ç½®æ¸²æŸ“åˆ°å±å¹•çš„æ¯ä¸ªå•ç‹¬çš„ç‰‡æ®µçš„é¢œè‰²ã€‚</p>

<h4 id="-shadermaterial-ç€è‰²å™¨æè´¨"><code class="language-plaintext highlighter-rouge">ğŸ’¡</code> ShaderMaterial ç€è‰²å™¨æè´¨</h4>

<p><code class="language-plaintext highlighter-rouge">Three.js</code> æ‰€è°“çš„æè´¨å¯¹è±¡ <code class="language-plaintext highlighter-rouge">Material</code> æœ¬è´¨ä¸Šå°±æ˜¯ç€è‰²å™¨ä»£ç å’Œéœ€è¦ä¼ é€’çš„ <code class="language-plaintext highlighter-rouge">uniform</code> æ•°æ®<strong>å…‰æºã€é¢œè‰²ã€çŸ©é˜µ</strong>ã€‚<code class="language-plaintext highlighter-rouge">Three.js</code> æä¾›å¯ç›´æ¥æ¸²æŸ“ç€è‰²å™¨è¯­æ³•çš„æè´¨ <code class="language-plaintext highlighter-rouge">ShaderMaterial</code> å’Œ <code class="language-plaintext highlighter-rouge">RawShaderMaterial</code>ã€‚</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">RawShaderMaterial</code>: å’ŒåŸç”Ÿ <code class="language-plaintext highlighter-rouge">WebGL</code> ä¸­ä¸€æ ·ï¼Œé¡¶ç‚¹ç€è‰²å™¨ã€ç‰‡å…ƒç€è‰²å™¨ä»£ç åŸºæœ¬æ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼Œä¸è¿‡é¡¶ç‚¹æ•°æ®å’Œ <code class="language-plaintext highlighter-rouge">uniform</code> æ•°æ®å¯ä»¥é€šè¿‡ <code class="language-plaintext highlighter-rouge">Three.js</code> çš„ <code class="language-plaintext highlighter-rouge">API</code> å¿«é€Ÿä¼ é€’ï¼Œè¦æ¯”ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">WebGL</code> åŸç”Ÿçš„ <code class="language-plaintext highlighter-rouge">API</code> ä¸ç€è‰²å™¨å˜é‡ç»‘å®šè¦æ–¹ä¾¿å¾—å¤šã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">ShaderMaterial</code>ï¼š<code class="language-plaintext highlighter-rouge">ShaderMaterial</code> æ¯” <code class="language-plaintext highlighter-rouge">RawShaderMaterial</code> æ›´æ–¹ä¾¿äº›ï¼Œç€è‰²å™¨ä¸­çš„å¾ˆå¤šå˜é‡ä¸ç”¨å£°æ˜ï¼Œ<code class="language-plaintext highlighter-rouge">Three.js</code> ç³»ç»Ÿä¼šè‡ªåŠ¨è®¾ç½®ï¼Œæ¯”å¦‚é¡¶ç‚¹åæ ‡å˜é‡ã€æŠ•å½±çŸ©é˜µã€è§†å›¾çŸ©é˜µç­‰ã€‚</li>
</ul>

<p><strong>æ„é€ å‡½æ•°</strong>ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ShaderMaterial(parameters : Object)
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">parameters</code>ï¼šå¯é€‰ï¼Œç”¨äºå®šä¹‰æè´¨å¤–è§‚çš„å¯¹è±¡ï¼Œå…·æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå±æ€§ã€‚</p>

<p><strong>å¸¸ç”¨å±æ€§</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">attributes[Object]</code>ï¼šæ¥å—å¦‚ä¸‹å½¢å¼çš„å¯¹è±¡ï¼Œ<code class="language-plaintext highlighter-rouge">{ attribute1: { value: []} }</code> æŒ‡å®šè¦ä¼ é€’ç»™é¡¶ç‚¹ç€è‰²å™¨ä»£ç çš„ <code class="language-plaintext highlighter-rouge">attributes</code>ï¼›é”®ä¸º <code class="language-plaintext highlighter-rouge">attribute</code> ä¿®é¥°å˜é‡çš„åç§°ï¼Œå€¼ä¹Ÿæ˜¯å¯¹è±¡æ ¼å¼ï¼Œå¦‚ <code class="language-plaintext highlighter-rouge">{ value: [] }</code>ï¼Œ <code class="language-plaintext highlighter-rouge">value</code> æ˜¯å›ºå®šåç§°ï¼Œå› ä¸º <code class="language-plaintext highlighter-rouge">attribute</code> ç›¸å¯¹äºæ‰€æœ‰é¡¶ç‚¹ï¼Œæ‰€ä»¥åº”è¯¥å›ä¼ ä¸€ä¸ªæ•°ç»„æ ¼å¼ã€‚åªæœ‰ <code class="language-plaintext highlighter-rouge">bufferGeometry</code> ç±»å‹çš„èƒ½ä½¿ç”¨è¯¥å±æ€§ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">.uniforms[Object]</code>ï¼šå¦‚ä¸‹å½¢å¼çš„å¯¹è±¡ï¼š<code class="language-plaintext highlighter-rouge">{ uniform1: { value: 1.0 }, uniform2: { value: 2.0 }}</code> æŒ‡å®šè¦ä¼ é€’ç»™<code class="language-plaintext highlighter-rouge">shader</code> ä»£ç çš„ <code class="language-plaintext highlighter-rouge">uniforms</code>ï¼›é”®ä¸º <code class="language-plaintext highlighter-rouge">uniform</code> çš„åç§°ï¼Œå€¼æ˜¯å¦‚ä¸‹å½¢å¼ï¼š<code class="language-plaintext highlighter-rouge">{ value: 1.0 }</code> è¿™é‡Œ <code class="language-plaintext highlighter-rouge">value</code> æ˜¯ <code class="language-plaintext highlighter-rouge">uniform</code> çš„å€¼ã€‚åç§°å¿…é¡»åŒ¹é…ç€è‰²å™¨ä»£ç ä¸­  <code class="language-plaintext highlighter-rouge">uniform</code> çš„ <code class="language-plaintext highlighter-rouge">name</code>ï¼Œå’Œ <code class="language-plaintext highlighter-rouge">GLSL</code> ä»£ç ä¸­çš„å®šä¹‰ä¸€æ ·ã€‚ æ³¨æ„ï¼Œ<code class="language-plaintext highlighter-rouge">uniforms</code> é€å¸§è¢«åˆ·æ–°ï¼Œæ‰€ä»¥æ›´æ–° <code class="language-plaintext highlighter-rouge">uniform</code> å€¼å°†ç«‹å³æ›´æ–° <code class="language-plaintext highlighter-rouge">GLSL</code> ä»£ç ä¸­çš„ç›¸åº”å€¼ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">.fragmentShader[String]</code>ï¼šç‰‡å…ƒç€è‰²å™¨çš„ <code class="language-plaintext highlighter-rouge">GLSL</code> ä»£ç ï¼Œå®ƒä¹Ÿå¯ä»¥ä½œä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ç›´æ¥ä¼ é€’æˆ–è€…é€šè¿‡ <code class="language-plaintext highlighter-rouge">AJAX</code> åŠ è½½ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">.vertexShader[String]</code>ï¼šé¡¶ç‚¹ç€è‰²å™¨çš„ <code class="language-plaintext highlighter-rouge">GLSL</code> ä»£ç ï¼Œå®ƒä¹Ÿå¯ä»¥ä½œä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ç›´æ¥ä¼ é€’æˆ–è€…é€šè¿‡ <code class="language-plaintext highlighter-rouge">AJAX</code> åŠ è½½ã€‚</li>
</ul>

<h3 id="-å²›">ğŸŒ´ å²›</h3>

<p>æ¥ç€ï¼Œä½¿ç”¨ <code class="language-plaintext highlighter-rouge">GLTFLoader</code> åŠ è½½å²›å±¿æ¨¡å‹å¹¶æ·»åŠ åˆ°åœºæ™¯ä¸­ã€‚åŠ è½½ä¹‹å‰å¯ä»¥ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">LoadingManager</code> æ¥ç®¡ç†åŠ è½½è¿›åº¦ã€‚</p>

<p><img src="https://img2022.cnblogs.com/blog/772544/202205/772544-20220527084647633-673151842.png" alt="" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const manager = new THREE.LoadingManager();
manager.onProgress = async(url, loaded, total) =&gt; {
  if (Math.floor(loaded / total * 100) === 100) {
    this.setState({ loadingProcess: Math.floor(loaded / total * 100) });
    Animations.animateCamera(camera, controls, { x: 0, y: 40, z: 140 }, { x: 0, y: 0, z: 0 }, 4000, () =&gt; {
      this.setState({ sceneReady: true });
    });
  } else {
    this.setState({ loadingProcess: Math.floor(loaded / total * 100) });
  }
};
const loader = new GLTFLoader(manager);
loader.load(islandModel, mesh =&gt; {
  mesh.scene.traverse(child =&gt; {
    if (child.isMesh) {
      child.material.metalness = .4;
      child.material.roughness = .6;
    }
  })
  mesh.scene.position.set(0, -2, 0);
  mesh.scene.scale.set(33, 33, 33);
  scene.add(mesh.scene);
});
</code></pre></div></div>

<p><img src="https://img2022.cnblogs.com/blog/772544/202205/772544-20220527084700152-531897880.png" alt="" /></p>

<h3 id="-é¸Ÿ">ğŸ¦… é¸Ÿ</h3>

<p>ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">GLTFLoader</code> åŠ è½½å²›å±¿æ¨¡å‹æ·»åŠ åˆ°åœºæ™¯ä¸­ï¼Œè·å–æ¨¡å‹è‡ªå¸¦çš„åŠ¨ç”»å¸§å¹¶è¿›è¡Œæ’­æ”¾ï¼Œè®°å¾—è¦åœ¨ <code class="language-plaintext highlighter-rouge">requestAnimationFrame</code> ä¸­æ›´æ–°åŠ¨ç”»ã€‚å¯ä»¥ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">clone</code> æ–¹æ³•åœ¨åœºæ™¯ä¸­æ·»åŠ å¤šåªé£é¸Ÿã€‚é¸Ÿæ¨¡å‹æ¥æºäº <code class="language-plaintext highlighter-rouge">Three.js</code> å®˜ç½‘ã€‚</p>

<p><img src="https://img2022.cnblogs.com/blog/772544/202205/772544-20220527084713125-1891687102.png" alt="" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>loader.load(flamingoModel, gltf =&gt; {
  const mesh = gltf.scene.children[0];
  mesh.scale.set(.35, .35, .35);
  mesh.position.set(-100, 80, -300);
  mesh.rotation.y = - 1;
  mesh.castShadow = true;
  scene.add(mesh);
  const mixer = new THREE.AnimationMixer(mesh);
  mixer.clipAction(gltf.animations[0]).setDuration(1.2).play();
  this.mixers.push(mixer);
});
</code></pre></div></div>

<p><img src="https://img2022.cnblogs.com/blog/772544/202205/772544-20220527084839955-1522409821.png" alt="" /></p>

<h3 id="-äº¤äº’ç‚¹">ğŸ– äº¤äº’ç‚¹</h3>

<p>æ·»åŠ äº¤äº’ç‚¹ï¼Œé¼ æ ‡ <code class="language-plaintext highlighter-rouge">hover</code> æ‚¬æµ®æ—¶æ˜¾ç¤ºæç¤ºè¯­ï¼Œç‚¹å‡»äº¤äº’ç‚¹å¯ä»¥åˆ‡æ¢é•œå¤´è§’åº¦ï¼Œè§†è§’èšç„¦åˆ°äº¤äº’ç‚¹å¯¹åº”çš„ä½ç½® <code class="language-plaintext highlighter-rouge">ğŸ“</code> ä¸Šã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const points = [
  {
    position: new THREE.Vector3(10, 46, 0),
    element: document.querySelector('.point-0')
  },
  // ...
];
document.querySelectorAll('.point').forEach(item =&gt; {
  item.addEventListener('click', event =&gt; {
    let className = event.target.classList[event.target.classList.length - 1];
    switch(className) {
      case 'label-0':
        Animations.animateCamera(camera, controls, { x: -15, y: 80, z: 60 }, { x: 0, y: 0, z: 0 }, 1600, () =&gt; {});
        break;
      // ...
    }
  }, false);
});
</code></pre></div></div>

<p><img src="https://img2022.cnblogs.com/blog/772544/202205/772544-20220527084853134-1885724838.png" alt="" /></p>

<h3 id="-åŠ¨ç”»">ğŸ¥ åŠ¨ç”»</h3>

<p>åœ¨ <code class="language-plaintext highlighter-rouge">requestAnimationFrame</code> ä¸­æ›´æ–°æ°´ã€é•œå¤´è½¨é“æ§åˆ¶å™¨ã€ç›¸æœºã€<code class="language-plaintext highlighter-rouge">TWEEN</code>ã€äº¤äº’ç‚¹ç­‰åŠ¨ç”»ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const animate = () =&gt; {
  requestAnimationFrame(animate);
  water.material.uniforms['time'].value += 1.0 / 60.0;
  controls &amp;&amp; controls.update();
  const delta = clock.getDelta();
  this.mixers &amp;&amp; this.mixers.forEach(item =&gt; {
    item.update(delta);
  });
  const timer = Date.now() * 0.0005;
  TWEEN &amp;&amp; TWEEN.update();
  camera &amp;&amp; (camera.position.y += Math.sin(timer) * .05);
  if (this.state.sceneReady) {
    // éå†æ¯ä¸ªç‚¹
    for (const point of points) {
      // è·å–2Då±å¹•ä½ç½®
      const screenPosition = point.position.clone();
      screenPosition.project(camera);
      raycaster.setFromCamera(screenPosition, camera);
      const intersects = raycaster.intersectObjects(scene.children, true);
      if (intersects.length === 0) {
        // æœªæ‰¾åˆ°ç›¸äº¤ç‚¹ï¼Œæ˜¾ç¤º
        point.element.classList.add('visible');
      } else {
        // æ‰¾åˆ°ç›¸äº¤ç‚¹
        // è·å–ç›¸äº¤ç‚¹çš„è·ç¦»å’Œç‚¹çš„è·ç¦»
        const intersectionDistance = intersects[0].distance;
        const pointDistance = point.position.distanceTo(camera.position);
        // ç›¸äº¤ç‚¹è·ç¦»æ¯”ç‚¹è·ç¦»è¿‘ï¼Œéšè—ï¼›ç›¸äº¤ç‚¹è·ç¦»æ¯”ç‚¹è·ç¦»è¿œï¼Œæ˜¾ç¤º
        intersectionDistance &lt; pointDistance ? point.element.classList.remove('visible') :  point.element.classList.add('visible');
      }
      const translateX = screenPosition.x * sizes.width * 0.5;
      const translateY = - screenPosition.y * sizes.height * 0.5;
      point.element.style.transform = `translateX(${translateX}px) translateY(${translateY}px)`;
    }
  }
  renderer.render(scene, camera);
}
animate();
}
</code></pre></div></div>

<h4 id="-raycaster-æ£€æµ‹é®æŒ¡"><code class="language-plaintext highlighter-rouge">ğŸ’¡</code> Raycaster æ£€æµ‹é®æŒ¡</h4>

<p>ä»”ç»†è§‚å¯Ÿï¼Œåœ¨ä¸Šè¿° <code class="language-plaintext highlighter-rouge">ğŸ‘†</code> æ›´æ–°äº¤äº’ç‚¹åŠ¨ç”»çš„æ–¹æ³•ä¸­ï¼Œé€šè¿‡ <code class="language-plaintext highlighter-rouge">raycaster</code> å°„çº¿æ¥æ£€æŸ¥äº¤äº’ç‚¹æ˜¯å¦è¢«ç‰©ä½“é®æŒ¡ï¼Œå¦‚æœè¢«é®æŒ¡å°±éšè—äº¤äº’ç‚¹ï¼Œå¦åˆ™æ˜¾ç¤ºäº¤äº’ç‚¹ï¼Œå¤§å®¶å¯ä»¥é€šè¿‡æ—‹è½¬åœºæ™¯è§‚å¯Ÿåˆ°è¿™ä¸€æ•ˆæœã€‚</p>

<p><img src="https://img2022.cnblogs.com/blog/772544/202205/772544-20220527084909950-1697050434.gif" alt="" /></p>

<h2 id="æ€»ç»“">æ€»ç»“</h2>

<p>æœ¬æ–‡åŒ…å«çš„æ–°çŸ¥è¯†ç‚¹ä¸»è¦åŒ…æ‹¬ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Tone Mapping</code></li>
  <li><code class="language-plaintext highlighter-rouge">Water</code> ç±»</li>
  <li><code class="language-plaintext highlighter-rouge">Sky</code> ç±»</li>
  <li><code class="language-plaintext highlighter-rouge">Shader</code> ç€è‰²å™¨</li>
  <li><code class="language-plaintext highlighter-rouge">ShaderMaterial</code> ç€è‰²å™¨æè´¨</li>
  <li><code class="language-plaintext highlighter-rouge">Raycaster</code> æ£€æµ‹é®æŒ¡</li>
</ul>

<blockquote>
  <p>æƒ³äº†è§£å…¶ä»–å‰ç«¯çŸ¥è¯†æˆ–å…¶ä»–æœªåœ¨æœ¬æ–‡ä¸­è¯¦ç»†æè¿°çš„ <code class="language-plaintext highlighter-rouge">Web 3D</code> å¼€å‘æŠ€æœ¯ç›¸å…³çŸ¥è¯†ï¼Œå¯é˜…è¯»æˆ‘å¾€æœŸçš„æ–‡ç« ã€‚<strong>è½¬è½½è¯·æ³¨æ˜åŸæ–‡åœ°å€å’Œä½œè€…</strong>ã€‚å¦‚æœè§‰å¾—æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œä¸è¦å¿˜äº†<strong>ä¸€é”®ä¸‰è¿å“¦ ğŸ‘</strong>ã€‚</p>
</blockquote>

<h2 id="å‚è€ƒ">å‚è€ƒ</h2>

<ul>
  <li>[1]. <a href="https://threejs.org">https://threejs.org</a></li>
</ul>

<h2 id="é™„å½•">é™„å½•</h2>

<ul>
  <li><a href="https://juejin.cn/column/7049923956257587213">æœ•çš„3Dä¸“æ </a></li>
  <li>[1]. <a href="https://juejin.cn/post/7081429595689320478">ğŸ¦Š Three.js å®ç°3Då¼€æ”¾ä¸–ç•Œå°æ¸¸æˆï¼šé˜¿ç‹¸çš„å¤šå…ƒå®‡å®™</a></li>
  <li>[2]. <a href="https://juejin.cn/post/7077726955528781832">ğŸ”¥ Three.js ç«ç„°æ•ˆæœå®ç°è‰¾å°”ç™»æ³•ç¯åŠ¨æ€logo</a></li>
  <li>[3]. <a href="https://juejin.cn/post/7060292943608807460">ğŸ¼ Three.js å®ç°2022å†¬å¥¥ä¸»é¢˜3Dè¶£å‘³é¡µé¢ï¼Œå«å†°å¢©å¢©</a></li>
  <li><code class="language-plaintext highlighter-rouge">...</code></li>
  <li>[1]. <a href="https://juejin.cn/post/7018722520345870350">ğŸ“· å‰ç«¯å®ç°å¾ˆå“‡å¡çš„æµè§ˆå™¨ç«¯æ‰«ç åŠŸèƒ½</a></li>
  <li>[2]. <a href="https://juejin.cn/post/7007432493569671182">ğŸŒ å‰ç«¯ç“¦ç‰‡åœ°å›¾åŠ è½½ä¹‹å¡å°”è¾¾ä¼ è¯´æ—·é‡ä¹‹æ¯</a></li>
  <li>[3]. <a href="https://juejin.cn/post/6972759988632551460">ğŸ˜± ä»…ç”¨CSSå‡ æ­¥å®ç°èµ›åšæœ‹å…‹2077é£æ ¼è§†è§‰æ•ˆæœ</a></li>
  <li><code class="language-plaintext highlighter-rouge">...</code></li>
</ul>

<blockquote>
  <p>æœ¬æ–‡ä½œè€…ï¼šdragonir  æœ¬æ–‡åœ°å€ï¼š<a href="https://www.cnblogs.com/dragonir/p/16316217.html">https://www.cnblogs.com/dragonir/p/16316217.html</a>
ä½œè€…:Dragonir
åŸæ–‡:https://www.cnblogs.com/dragonir/p/16316217.html</p>
</blockquote>

  </div><a class="u-url" href="/cnblog/2022/05/27/Three.js-%E6%89%93%E9%80%A0%E7%BC%A4%E7%BA%B7%E5%A4%8F%E6%97%A53D%E6%A2%A6%E4%B8%AD%E6%83%85%E5%B2%9B.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">dotnetä¹‹ç¾</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">dotnetä¹‹ç¾</li><li><a class="u-email" href="mailto:springhgui@outlook.com">springhgui@outlook.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>åˆ†äº«dotnetæŠ€æœ¯.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
